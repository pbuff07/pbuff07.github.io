---
title: Excel字段转Json
date: 2025-03-19 14:00:00 +/-TTTT
categories: [杂文]
tags: ['Excel', 'json', 'awk']     # TAG names should always be lowercase
---



工作中突然有个需求是对从ZoomEye导出的网络资产进行处理（默认是CSV格式），需要讲IP、PORT字段抽出来然后处理成一个Json文件用于探测程序扫描。

处理的时候脑子抽了还让GPT帮我写了个Python脚本处理，处理完了后才想起来似乎搞复杂了？。。

事后才反应过来如果字段比较少的话直接用awk或者sed处理不是更快？

假设从Excel复制出来的数据示例如下（Excel粘贴出来默认是\t分割），需要处理成{"url":"ip:port"}

```
61.54.25.50	9997
39.101.177.202	6006
121.40.88.163	23043
47.120.30.18	9997
106.120.41.178	9998
```

awk版本（注意：awk时变量不能直接写在字符串里面）

```shell
awk -F '\t' '{print "{\"url:\" \""$1":"$2"\"}" }' test.txt
```

sed版本

```shell
sed 's/\t/:/;s/^/{\"url:\"/;s/$/\"}/' test.txt 
```



等我再回想这个事情的时候，自己竟然开始用C写了一个基于字符串的模版的文本处理程序，看来最近被某个傻逼摧残得有点神经了。。。